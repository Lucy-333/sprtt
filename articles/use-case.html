<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Example Use Case ‚Ä¢ sprtt</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Example Use Case">
<meta property="og:description" content="sprtt">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sprtt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/sequential_testing.html">Sequential t-test</a>
    </li>
    <li>
      <a href="../articles/usage-sprtt.html">How to use the sprtt package</a>
    </li>
    <li>
      <a href="../articles/use-case.html">Example Use Case</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MeikeSteinhilber/sprtt/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="use-case_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Example Use Case</h1>
                        <h4 class="author">Meike Steinhilber</h4>
            
            <h4 class="date">2021-03-31</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MeikeSteinhilber/sprtt/blob/master/vignettes/use-case.Rmd"><code>vignettes/use-case.Rmd</code></a></small>
      <div class="hidden name"><code>use-case.Rmd</code></div>

    </div>

    
    
<div id="note" class="section level2">
<h2 class="hasAnchor">
<a href="#note" class="anchor"></a>Note</h2>
<p>In the R code sections:</p>
<p><code># comment</code>: is a comment</p>
<p><code>function()</code>: is R code</p>
<p><code>#&gt; results of function()</code>: is console output</p>
</div>
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>The <code>sprtt</code> package is the implementation of <strong>s</strong>equential <strong>p</strong>robability <strong>r</strong>atio <strong>t</strong>ests using the associated <strong>t</strong>-statistic (<strong>sprtt</strong>). This vignette describes an exemplary use case to improve the understanding of the package and the sequential t-test.</p>
<p>Other recommended vignettes cover:</p>
<ul>
<li><p>the theoretical background: <strong>LINK</strong> and,</p></li>
<li><p>a general guide, how to use the package <strong>LINK</strong></p></li>
</ul>
</div>
<div id="use-case" class="section level2">
<h2 class="hasAnchor">
<a href="#use-case" class="anchor"></a>Use Case</h2>
<p>A team of researchers wants to know if the stress of the employees increased in the company Test AG over the last year. The Human Resources department has gathered data from a new self-care tool they implemented for the employees. It is difficult to predict how many employees will still participate at the second measurement point (one year after the baseline). The team suggests using a sequential t-test instead of a Students t-test, because the sequential procedure can reduce the required sample size and is stopped right after the decision for one of the hypotheses. Furthermore, the sequential t-test is able to gather evidence for both the alternative and the null hypothesis.</p>
<div id="hypothesis" class="section level3">
<h3 class="hasAnchor">
<a href="#hypothesis" class="anchor"></a>Hypothesis</h3>
<p>The researchers know that the company has received more orders than in the year before. Thus, they do expect an increase in self-reported stress.</p>
</div>
<div id="data-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#data-analysis" class="anchor"></a>Data Analysis</h3>
<p>The parameters of the sequential t-test are specified as follows:</p>
<ul>
<li>
<p>The researchers expect an increase in stress but they have no prior knowledge about the expected effect size. Thus, they define the lower limit of a substantial effect for their research interest.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op">=</span> <span class="fl">0.2</span></code></pre></div>
</li>
<li>
<p>They choose the common alpha level of .05 and the same level for the beta error probability, which leads to a power of .95 (1 - ùõΩ).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alpha</span> <span class="op">=</span> <span class="fl">0.05</span>
<span class="va">power</span> <span class="op">=</span> <span class="fl">0.95</span></code></pre></div>
</li>
<li>
<p>The data are repeated measures, therefore the test is a paired sequential t-test.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">paired</span> <span class="op">=</span> <span class="cn">TRUE</span></code></pre></div>
</li>
<li>
<p>The researchers expect that the stress will have increased after one year. Thus, they specify that the true difference in means is greater than 0.<br><code>(mean(one_year_stress) - mean(baseline_stress)) &gt; 0</code></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alternative</span> <span class="op">=</span> <span class="st">"greater"</span></code></pre></div>
</li>
</ul>
<p>The HR department receives the new data piece by piece and passes it on directly to the researchers. The test is performed for the first time and starts with the first two data points.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># first data from the Human Resources department -------------------------------</span>
<span class="co"># current sample size</span>
<span class="va">n_person</span> <span class="op">=</span> <span class="fl">2</span>

<span class="co"># get data</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_stress</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n_person</span>,<span class="op">]</span>

<span class="co"># print data</span>
<span class="va">df</span>
<span class="co">#&gt;   baseline_stress one_year_stress</span>
<span class="co">#&gt; 1        7.175250        7.844337</span>
<span class="co">#&gt; 2        4.918343        5.527191</span>

<span class="co"># sequential t-test ------------------------------------------------------------</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seq_ttest.html">seq_ttest</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">one_year_stress</span>,
                     <span class="va">df</span><span class="op">$</span><span class="va">baseline_stress</span>,
                     alpha <span class="op">=</span> <span class="va">alpha</span>,
                     power <span class="op">=</span> <span class="va">power</span>,
                     d <span class="op">=</span> <span class="va">d</span>,
                     paired <span class="op">=</span> <span class="va">paired</span>,
                     alternative <span class="op">=</span> <span class="va">alternative</span><span class="op">)</span>

<span class="co"># print results: entire output--------------------------------------------------</span>
<span class="va">results</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; *****  Sequential Paired t-test *****</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data: df$one_year_stress and  df$baseline_stress</span>
<span class="co">#&gt; test statistic:</span>
<span class="co">#&gt;  log-likelihood ratio = 0.33191, decision = continue sampling</span>
<span class="co">#&gt; SPRT thresholds:</span>
<span class="co">#&gt;  lower log(B) = -2.94444, upper log(A) = 2.94444</span>
<span class="co">#&gt; Log-Likelihood of the:</span>
<span class="co">#&gt;  alternative hypothesis = -6.92437</span>
<span class="co">#&gt;  null hypothesis = -7.25627</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is greater than 0.</span>
<span class="co">#&gt; specified effect size: Cohen's d = 0.2</span>
<span class="co">#&gt; degrees of freedome: df = 1</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean of the differences </span>
<span class="co">#&gt;                 0.63897 </span>
<span class="co">#&gt; Note: to get access to the object of the results use the @ or []</span>
<span class="co">#&gt;           instead of the $ operator.</span></code></pre></div>
<p>The decision from the first test is:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results</span><span class="op">@</span><span class="va">decision</span>
<span class="co">#&gt; [1] "continue sampling"</span></code></pre></div>
<p>As a result, the researchers take one more data point and run the test again.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># new data from the Human Resources department ---------------------------------</span>
<span class="co"># get one more person</span>
<span class="va">n_person</span> <span class="op">=</span> <span class="va">n_person</span> <span class="op">+</span> <span class="fl">1</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_stress</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n_person</span>,<span class="op">]</span>

<span class="co"># print new data</span>
<span class="va">df</span>
<span class="co">#&gt;   baseline_stress one_year_stress</span>
<span class="co">#&gt; 1        7.175250        7.844337</span>
<span class="co">#&gt; 2        4.918343        5.527191</span>
<span class="co">#&gt; 3        4.634266        5.783046</span>

<span class="co"># sequential t-test ------------------------------------------------------------</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seq_ttest.html">seq_ttest</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">one_year_stress</span>,
                     <span class="va">df</span><span class="op">$</span><span class="va">baseline_stress</span>,
                     alpha <span class="op">=</span> <span class="va">alpha</span>,
                     power <span class="op">=</span> <span class="va">power</span>,
                     d <span class="op">=</span> <span class="va">d</span>,
                     paired <span class="op">=</span> <span class="va">paired</span>,
                     alternative <span class="op">=</span> <span class="va">alternative</span><span class="op">)</span>

<span class="co"># print results ----------------------------------------------------------------</span>
<span class="va">results</span><span class="op">@</span><span class="va">decision</span>
<span class="co">#&gt; [1] "continue sampling"</span></code></pre></div>
<p>This process is repeated until the decision is made for one of the two hypotheses. To simulate this sequential process, a while-loop embraces the sequential t-test function in the code below, which will not stop until the decision is to accept one of the hypotheses or the maximum of the data is reached.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># define the starting point ----------------------------------------------------</span>
<span class="va">decision</span> <span class="op">=</span> <span class="st">"continue sampling"</span>
<span class="va">n_person</span> <span class="op">=</span> <span class="fl">3</span>

<span class="co"># simulation of the sequential procedure ---------------------------------------</span>
<span class="kw">while</span><span class="op">(</span><span class="va">decision</span> <span class="op">==</span> <span class="st">"continue sampling"</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># get the current data</span>
  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df_stress</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n_person</span>,<span class="op">]</span>
  
  <span class="co"># run the sequential test and save the results</span>
  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seq_ttest.html">seq_ttest</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">one_year_stress</span>,
                       <span class="va">df</span><span class="op">$</span><span class="va">baseline_stress</span>,
                       alpha <span class="op">=</span> <span class="va">alpha</span>,
                       power <span class="op">=</span> <span class="va">power</span>,
                       d <span class="op">=</span> <span class="va">d</span>,
                       paired <span class="op">=</span> <span class="va">paired</span>,
                       alternative <span class="op">=</span> <span class="va">alternative</span><span class="op">)</span>
  <span class="co"># save the current desicion</span>
  <span class="va">decision</span> <span class="op">=</span> <span class="va">results</span><span class="op">@</span><span class="va">decision</span>
  
  <span class="co"># add a new person</span>
  <span class="va">n_person</span> <span class="op">=</span> <span class="va">n_person</span> <span class="op">+</span> <span class="fl">1</span>
  
  <span class="co"># break if the maximum of the data is reached</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">n_person</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df_stress</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw">break</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p>The while-loop comes to an end after the 48 data points.</p>
</div>
<div id="results" class="section level3">
<h3 class="hasAnchor">
<a href="#results" class="anchor"></a>Results</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># print results: entire output -------------------------------------------------</span>
<span class="va">results</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; *****  Sequential Paired t-test *****</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data: df$one_year_stress and  df$baseline_stress</span>
<span class="co">#&gt; test statistic:</span>
<span class="co">#&gt;  log-likelihood ratio = 2.98795, decision = accept H1</span>
<span class="co">#&gt; SPRT thresholds:</span>
<span class="co">#&gt;  lower log(B) = -2.94444, upper log(A) = 2.94444</span>
<span class="co">#&gt; Log-Likelihood of the:</span>
<span class="co">#&gt;  alternative hypothesis = -2.23785</span>
<span class="co">#&gt;  null hypothesis = -5.2258</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is greater than 0.</span>
<span class="co">#&gt; specified effect size: Cohen's d = 0.2</span>
<span class="co">#&gt; degrees of freedome: df = 47</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean of the differences </span>
<span class="co">#&gt;                 0.47931 </span>
<span class="co">#&gt; Note: to get access to the object of the results use the @ or []</span>
<span class="co">#&gt;           instead of the $ operator.</span></code></pre></div>
<p>The researchers‚Äô hypothesis can be confirmed. The stress increased one year after the baseline measure.</p>
<!--# Wie Zitiert man den Test? -->
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># NOT IN THE PACKAGE INCLUDED</span>
<span class="co"># calculate effect size: Cohen¬¥s d ---------------------------------------------</span>
<span class="fu">effsize</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/effsize/man/cohen.d.html">cohen.d</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">one_year_stress</span>,
                 <span class="va">df</span><span class="op">$</span><span class="va">baseline_stress</span>,
                 paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Cohen's d</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; d estimate: 0.3388435 (small)</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;     lower     upper </span>
<span class="co">#&gt; 0.1110771 0.5666099</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Meike Steinhilber, Martin Schnuerch, Anna-Lena Schubert.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
